"use strict";(()=>{var e={};e.id=426,e.ids=[426],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4770:e=>{e.exports=require("crypto")},665:e=>{e.exports=require("dns")},7702:e=>{e.exports=require("events")},2048:e=>{e.exports=require("fs")},2615:e=>{e.exports=require("http")},2694:e=>{e.exports=require("http2")},8216:e=>{e.exports=require("net")},9801:e=>{e.exports=require("os")},5315:e=>{e.exports=require("path")},5816:e=>{e.exports=require("process")},6162:e=>{e.exports=require("stream")},2452:e=>{e.exports=require("tls")},7360:e=>{e.exports=require("url")},1764:e=>{e.exports=require("util")},1568:e=>{e.exports=require("zlib")},3353:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>x,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>A,staticGenerationAsyncStorage:()=>g});var s={};t.r(s),t.d(s,{GET:()=>c,POST:()=>d});var a=t(9303),i=t(8716),o=t(670),n=t(7070),u=t(8629),l=t(9419);async function c(e){try{let r;console.log("\uD83D\uDD0D Alumni API: Starting request...");let{searchParams:t}=new URL(e.url),s=t.get("strand")??void 0,a=t.get("q")?.toLowerCase()??"";console.log("\uD83D\uDD0D Alumni API: Query params -",{strand:s,searchQuery:a});let i=(0,u.hJ)(l.db,"alumni");s?(r=(0,u.IO)(i,(0,u.ar)("strand","==",s),(0,u.ar)("status","==","approved")),console.log("\uD83D\uDD0D Alumni API: Using strand filter + approved status (no orderBy to avoid index requirement)")):(r=(0,u.IO)(i,(0,u.ar)("status","==","approved"),(0,u.Xo)("createdAt","desc")),console.log("\uD83D\uDD0D Alumni API: Using approved status filter with orderBy")),console.log("\uD83D\uDD0D Alumni API: Executing Firestore query...");let o=await (0,u.PL)(r),c=[];return o.forEach(e=>{let r=e.data();c.push({id:e.id,name:r.name,strand:r.strand,collegeCourse:r.collegeCourse,currentOccupation:r.currentOccupation,credentialsInField:r.credentialsInField||"",email:r.email||"",status:r.status||"approved",createdAt:r.createdAt,updatedAt:r.updatedAt})}),s&&(c.sort((e,r)=>e.createdAt&&r.createdAt&&"seconds"in e.createdAt&&"seconds"in r.createdAt?r.createdAt.seconds-e.createdAt.seconds:0),console.log("✅ Alumni API: Client-side sorting applied")),console.log(`✅ Alumni API: Found ${c.length} records`),a&&(c=c.filter(e=>`${e.name} ${e.strand} ${e.collegeCourse} ${e.currentOccupation} ${e.credentialsInField}`.toLowerCase().includes(a)),console.log(`✅ Alumni API: After search filter: ${c.length} records`)),n.NextResponse.json(c)}catch(e){return console.error("❌ Alumni API Error:",{message:e.message,code:e.code,stack:e.stack?.split("\n").slice(0,3)}),n.NextResponse.json({error:"Failed to read alumni data",details:e.message,code:e.code,rows:[]},{status:500})}}async function d(e){try{let{name:r,strand:t,collegeCourse:s,currentOccupation:a,credentialsInField:i}=await e.json();if(!r||!t||!s||!a)return n.NextResponse.json({error:"Name, strand, college course, and current occupation are required"},{status:400});let o=(0,u.hJ)(l.db,"alumni"),c=(0,u.IO)(o,(0,u.ar)("name","==",r),(0,u.ar)("strand","==",t));if(!(await (0,u.PL)(c)).empty)return n.NextResponse.json({error:"An alumni with this name and strand already exists"},{status:409});let d={name:r,strand:t,collegeCourse:s,currentOccupation:a,credentialsInField:i||"",status:"pending",createdAt:(0,u.Bt)(),updatedAt:(0,u.Bt)()},p={id:(await (0,u.ET)(o,d)).id,...d};return n.NextResponse.json({message:"Alumni registration submitted successfully! Your registration is pending approval by the school registrar.",alumni:p,status:"pending"},{status:201})}catch(e){return console.error("Error registering alumni:",e),n.NextResponse.json({error:"Failed to register alumni. Please try again."},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/alumni/route",pathname:"/api/alumni",filename:"route",bundlePath:"app/api/alumni/route"},resolvedPagePath:"C:\\Users\\adestajo\\Desktop\\REPO\\New folder\\Alumni Tracking Website\\src\\app\\api\\alumni\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:A}=p,h="/api/alumni/route";function x(){return(0,o.patchFetch)({serverHooks:A,staticGenerationAsyncStorage:g})}},9419:(e,r,t)=>{let s;t.d(r,{db:()=>n});var a=t(9362),i=t(8629);let o={apiKey:"AIzaSyAm0MdHaVr6cVA147cwMQiCL7wvpB1c1Ho",authDomain:"scihi-alumni-tracking.firebaseapp.com",projectId:"scihi-alumni-tracking",storageBucket:"scihi-alumni-tracking.firebasestorage.app",messagingSenderId:"776095020338",appId:"1:776095020338:web:77e44b70e46d77203e932b"};try{(function(){let e=["apiKey","authDomain","projectId","appId"].filter(e=>!o[e]);if(e.length>0)throw console.error("❌ Firebase configuration is incomplete. Missing:",e),console.error("Make sure you have a .env.local file with all NEXT_PUBLIC_FIREBASE_* variables"),Error(`Firebase configuration missing: ${e.join(", ")}`)})(),s=0===(0,a.C6)().length?(0,a.ZF)(o):(0,a.Mq)(),console.log("✅ Firebase initialized successfully for project:",o.projectId)}catch(e){throw console.error("❌ Firebase initialization failed:",e),e}let n=(0,i.ad)(s)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,532],()=>t(3353));module.exports=s})();